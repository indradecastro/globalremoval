---
title: "Correlations"
author: "indra deCastro"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    theme: united
---
      
<style type="text/css">
      .table {
            width: 100%;
      }
</style>
      
```{r setup, include=FALSE}
# setwd("/home/indra/Documents/20160101.Noriega.exp.remocion/")
knitr::opts_knit$set(root.dir ="/home/indra/Documents/20160101.Noriega.exp.remocion/", message=F, warning=F, verbose=F, comment=F)
knitr::opts_chunk$set(message=F, warning=F, verbose=F, echo=F, autodep=T, cache=T, fig.width=10)
options(markdown.HTML.header = system.file("misc", "datatables.html", package = "knitr"))
```

## Import data
```{r import, echo=T}
raw <- read.table("data/all.csv", header=T, sep=";")
```


## Select variables to explore correlations
Variables of interest:

- taxonomic: "abun", "rich", "even"
- climatic: paste0("BIO.", 1:19)
- removal: "rem.met1", "rem.met2"
- geographical: "lat", "altitud"
- manegement: "land.history", "cow.dens"
- functional for 9 relocationXsize categories: "Fric.behav", "Feve.behav", "Fdis.behav", "RaoQ.behav", "mpd.behav" (*"Fdiv.behav" cant be calculated if only categorical traits are used*)
- functional for morphological: "Fric.morph", "Feve.morph", "Fdiv.morph", "Fdis.morph", "RaoQ.morph", "mpd.morph" traits

### Names of all variables
- BIO1 = Annual Mean Temperature
- BIO2 = Mean Diurnal Range (Mean of monthly (max temp - min temp))
- BIO3 = Isothermality (- BIO2/- BIO7) (* 100)
- BIO4 = Temperature Seasonality (standard deviation *100)
- BIO5 = Max Temperature of Warmest Month
- BIO6 = Min Temperature of Coldest Month
- BIO7 = Temperature Annual Range (- BIO5-- BIO6)
- BIO8 = Mean Temperature of Wettest Quarter
- BIO9 = Mean Temperature of Driest Quarter
- BIO10 = Mean Temperature of Warmest Quarter
- BIO11 = Mean Temperature of Coldest Quarter
- BIO12 = Annual Precipitation
- BIO13 = Precipitation of Wettest Month
- BIO14 = Precipitation of Driest Month
- BIO15 = Precipitation Seasonality (Coefficient of Variation)
- BIO16 = Precipitation of Wettest Quarter
- BIO17 = Precipitation of Driest Quarter
- BIO18 = Precipitation of Warmest Quarter
- BIO19 = Precipitation of Coldest Quarter

```{r, echo=F}
foc.names <- c("abun", "rich", "even", # taxonomic
               paste0("BIO.", 1:19), # climatic
               "rem.met1", "rem.met2", # removal
               "lat", "altitud", # geographical
               "land.history", "cow.dens", # manegement
               "Fric.behav", "Feve.behav", "Fdis.behav", "RaoQ.behav", "mpd.behav", # functional for 9 relocationXsize categories
               # "Fdiv.behav" cant be calculated if only categorical traits are used 
               "Fric.morph", "Feve.morph", "Fdiv.morph", "Fdis.morph", "RaoQ.morph", "mpd.morph") # functional for morphological traits
foc <- raw[,foc.names]
```

## Calculate correlations and filter
Criteria:  

- 0.5 as arbitrary threshold
- identity corelations (Var1 = Var2)
- correlation between climatic variables (both climatic)

```{r, echo=F}
library(dplyr)
library(reshape2)

allcor <- as.matrix(cor(foc))
allcor.melt <- arrange(melt(allcor), -abs(value))
dplyr::filter(allcor.melt,
              value > .5 & # .5 is arbitrary
              value != 1 & # these are just identity corelations (Var1 = Var2)
              paste0(substr(Var1, 1,3), substr(Var2, 1,3)) != "BIOBIO") 

```

